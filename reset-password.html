<!-- reset-password.html -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ลืมรหัสผ่าน</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.0/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 flex justify-center items-center min-h-screen">
  <div class="bg-white rounded-xl shadow-xl p-8 max-w-sm w-full">
    <h2 class="text-2xl font-bold text-center mb-6">ลืมรหัสผ่าน</h2>

    <label for="reset-email" class="block text-sm font-medium text-gray-700">กรุณากรอกอีเมลที่คุณใช้สมัครสมาชิก</label>
    <input type="email" id="reset-email" class="w-full mb-4 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-400 transition text-sm text-gray-900" placeholder="อีเมล" />

    <button onclick="sendResetEmail()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-semibold transition">
      ส่งคำขอรีเซ็ตรหัสผ่าน
    </button>

    <p class="text-center text-sm text-gray-600 mt-6">
      <a href="login.html" class="text-purple-600 font-medium hover:underline">กลับสู่หน้าล็อกอิน</a>
    </p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAuWomazKXngJRI5eGaLs3YPNJ0fQ1-_Hc",
      authDomain: "gzone-store.firebaseapp.com",
      projectId: "gzone-store",
      storageBucket: "gzone-store.firebasestorage.app",
      messagingSenderId: "20383169229",
      appId: "1:20383169229:web:e225735efbea6589120784"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    async function sendResetEmail() {
      const email = document.getElementById('reset-email').value.trim();

      if (!email) {
        alert('กรุณากรอกอีเมล');
        return;
      }

      try {
        // เช็คว่าอีเมลมีในระบบหรือไม่
        const userRecord = await auth.fetchSignInMethodsForEmail(email);
        if (userRecord.length === 0) {
          alert('ไม่พบอีเมลนี้ในระบบ');
          return;
        }

        // ส่งอีเมลรีเซ็ตรหัสผ่าน
        await auth.sendPasswordResetEmail(email);
        alert('คำขอรีเซ็ตรหัสผ่านถูกส่งไปยังอีเมลของคุณแล้ว');
        window.location.href = "login.html"; // ไปหน้าล็อกอินหลังจากรีเซ็ตรหัสผ่าน
      } catch (error) {
        console.error(error);
        alert('เกิดข้อผิดพลาด: ' + error.message);
      }
    }
  </script>
</body>
</html>
