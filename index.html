<!DOCTYPE html>
<html lang="th" class="bg-[#1e0a2a] text-white">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#1e0a2a" />
  <title>GZONE</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/heroicons@2.0.16/dist/outline.min.js"></script>
  <link rel="manifest" href="./manifest.json" />
  <link rel="apple-touch-icon" href="images/icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <style>
    @keyframes marquee {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    .animate-marquee {
      display: inline-block;
      white-space: nowrap;
      animation: marquee 15s linear infinite;
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 9999px;
      margin: 0 4px;
      background-color: white;
      opacity: 0.5;
    }

    .dot.active {
      background-color: #a855f7;
      opacity: 1;
    }
  </style>
</head>
  
<body class="flex flex-col min-h-screen">

  <!-- โลโก้ -->
<div id="logoBar" class="fixed top-0 w-full bg-[#1e0a2a] z-20">
  <div class="p-4">
    <img src="logo.png" alt="Logo" class="h-10 mx-auto" />
  </div>
</div>

    <!-- หน้าแรก -->
    <div id="home" class="flex-1 pb-16 block pt-20">
     <!-- แบนเนอร์ -->
<div class="relative w-full overflow-hidden h-40">
  <div id="banner-carousel" class="flex transition-transform duration-500 ease-in-out">
    <img src="banner3.png" class="w-full h-40 object-cover flex-shrink-0" />
    <img src="banner1.jpg" class="w-full h-40 object-cover flex-shrink-0" />
    <img src="banner2.jpg" class="w-full h-40 object-cover flex-shrink-0" />
    <img src="banner3.png" class="w-full h-40 object-cover flex-shrink-0" />
    <img src="banner1.jpg" class="w-full h-40 object-cover flex-shrink-0" />
    <img src="banner1.jpg" class="w-full h-40 object-cover flex-shrink-0" />
  </div>
  
  <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex">
    <div class="dot" id="dot0"></div>
    <div class="dot" id="dot1"></div>
    <div class="dot" id="dot2"></div>
  </div>
</div>

      <!-- ประกาศ -->
      <div class="bg-[#2e1b44] px-4 py-2 mt-2 overflow-hidden text-sm">
        <div class="whitespace-nowrap animate-marquee">
          <span class="mr-6">ประกาศ: เกมใหม่มาแล้ว! อย่าลืมลองโหลดดูนะครับ</span>
          <span class="mr-6">โปรโมชั่นเดือนนี้ โหลดฟรีไม่เสียค่าใช้จ่าย!</span>
        </div>
      </div>

      <!-- หัวข้อ -->
      <h2 class="text-lg font-bold px-4 pt-4">เกมยอดนิยม</h2>

      <!-- รายการเกม -->
<div class="grid grid-cols-2 gap-4 p-4" id="game-list"></div>

<script>
  const gameList = [  
    { name: "Love Warriors", image: "game1.png.jpg", link: "https://example.com/love-warriors" },  
    { name: "Love & Battle", image: "game2.png.jpg", link: "https://example.com/love-battle" },  
    { name: "Zombie Fight", image: "game3.png.jpg", link: "https://example.com/zombie-fight" },  
    { name: "Car Drift", image: "game4.png.jpg", link: "https://example.com/car-drift" },  
    { name: "Shooting Pro", image: "game5.png.jpg", link: "https://example.com/shooting-pro" },  
    { name: "Dragon Love", image: "game6.png.jpg", link: "https://example.com/dragon-love" },  
    { name: "Adventure World", image: "game7.png.jpg", link: "https://example.com/adventure-world" },  
    { name: "Puzzle Love", image: "game8.png.jpg", link: "https://example.com/puzzle-love" },  
    { name: "GZONE STORE", image: "gzone.png.png", link: "https://example.com/gzone-store" },  
  ];
  
  document.addEventListener("DOMContentLoaded", () => {
    const grid = document.querySelector("#game-list");
    if (!grid) return;
    gameList.forEach(game => {
      const div = document.createElement("div");
      div.className = "bg-[#2b1140] rounded-2xl p-2 text-left";
      div.innerHTML = `
        <img src="${game.image}" alt="${game.name}" class="rounded-xl mb-2" />
        <div class="text-white font-semibold">${game.name}</div>
        <a href="${game.link}" target="_blank" class="bg-purple-500 block text-center mt-2 py-1 rounded-xl">ดาวน์โหลด</a>
      `;
      grid.appendChild(div);
    });

    if (typeof goTo === 'function') {
      goTo("home");
    }
  });
</script>
    </div>
  </div>

  <!-- หน้าค้นหา -->
<div id="search" class="hidden flex-1 pb-16">
  <div class="fixed top-0 w-full bg-[#1e0a2a] z-10 p-4 flex items-center">
    <input type="text" id="searchInput" placeholder="ค้นหาเกมที่นี่..." class="flex-1 rounded-full border border-gray-300 px-4 py-2 text-sm text-black" />
    <button id="searchButton" class="ml-2 p-2 bg-purple-500 rounded-full">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M17 11a6 6 0 11-12 0 6 6 0 0112 0z" />
      </svg>
    </button>
  </div>
  <div class="pt-20 px-4 pb-4 space-y-3 text-white text-sm" id="searchResults"></div>
</div>
  
    <!-- Firebase App -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAuWomazKXngJRI5eGaLs3YPNJ0fQ1-_Hc",
      authDomain: "gzone-store.firebaseapp.com",
      projectId: "gzone-store",
      storageBucket: "gzone-store.appspot.com",
      messagingSenderId: "20383169229",
      appId: "1:20383169229:web:e225735efbea6589120784",
      measurementId: "G-WZLDR9JQKS"
    };

    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  </script>
  
  <!-- หน้าบัญชี -->
<div id="account" class="hidden flex-1 pb-16">
  <div class="relative">
    <img src="cover.png" class="w-full h-32 object-cover" />
    
    <!-- ปุ่มไอคอนตั้งค่า -->
    <button id="open-settings-btn" aria-label="ตั้งค่า" 
      style="
        position: absolute;
        top: 8px;
        right: 8px;
        background: rgba(0,0,0,0.5);
        border-radius: 50%;
        padding: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        border: none;
      "
      onmouseover="this.style.background='rgba(0,0,0,0.8)'" 
      onmouseout="this.style.background='rgba(0,0,0,0.5)'"
    >
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="white" stroke-width="2" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" 
          d="M11.983 4.533c.29-.28.79-.28 1.08 0l1.383 1.346a2 2 0 002.57.145l1.403-1.22a.75.75 0 011.04.41l1.02 2.528a.75.75 0 01-.338 1.02l-1.352.72a2 2 0 00-.81 2.37l.45 1.33a.75.75 0 01-1.15.87l-1.457-1.25a2 2 0 00-2.658.12l-1.35 1.38a.75.75 0 01-1.08 0l-1.353-1.38a2 2 0 00-2.658-.12l-1.457 1.25a.75.75 0 01-1.15-.87l.45-1.33a2 2 0 00-.81-2.37l-1.352-.72a.75.75 0 01-.338-1.02l1.02-2.528a.75.75 0 011.04-.41l1.403 1.22a2 2 0 002.57-.145l1.383-1.346z"/>
        <circle cx="12" cy="12" r="3"/>
      </svg>
    </button>

    <div class="absolute -bottom-10 left-1/2 transform -translate-x-1/2">
      <!-- รูปโปรไฟล์ -->
      <img id="accountProfileImage" src="profile.png" class="w-20 h-20 rounded-full border-4 border-[#1e0a2a] object-cover" />
    </div>
  </div>

  <div class="mt-14 text-center" id="user-info">
    <!-- เมื่อยังไม่ล็อกอิน -->
    <div id="login-prompt" class="flex justify-center mt-4 w-full">
      <button
        onclick="openAuthModal()"
        class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold py-1.5 px-6 rounded-full shadow-md hover:from-indigo-700 hover:to-purple-700 hover:shadow-lg transition duration-300 text-sm"
        id="login-button"
      >
        เข้าสู่ระบบ | สมัครสมาชิก
      </button>
    </div>
    
    <!-- เมื่อล็อกอินแล้ว -->
    <div id="profile" class="mt-4 text-center"></div>
    <div class="hidden text-center flex flex-col items-center mt-4" id="user-details">
      <div class="text-xl font-bold" id="user-name">name</div>
      <div class="text-sm text-gray-300" id="user-email">email</div>
      <button onclick="window.location.href='editprofile.html'" class="mt-2 text-sm text-purple-400 hover:underline">
        <svg xmlns="http://www.w3.org/2000/svg" class="inline w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536M9 11l6-6 3 3-6 6H9v-3z" />
        </svg>
        แก้ไขโปรไฟล์
      </button>
    </div>
  </div>
</div>

  <!-- เมื่อล็อกอินแล้ว -->
<!-- กล่องแสดงข้อมูลผู้ใช้ -->
<div id="profile" class="mt-4 text-center"></div>
<div class="hidden text-center flex flex-col items-center mt-4" id="user-details">
  <div class="text-xl font-bold" id="user-name">name</div>
  <div class="text-sm text-gray-300" id="user-email">email</div>
  <button onclick="window.location.href='editprofile.html'" class="mt-2 text-sm text-purple-400 hover:underline">
    <svg xmlns="http://www.w3.org/2000/svg" class="inline w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536M9 11l6-6 3 3-6 6H9v-3z" />
    </svg>
    แก้ไขโปรไฟล์
  </button>
</div>
    
   <!-- ย้ายเมนูทั้งหมดมาอยู่ในนี้ -->
<div class="mt-8 space-y-3 px-6" id="account-menu">
  <!-- Support / Donate -->
  <details class="group bg-[#2e1b44] rounded-xl px-4 py-3">
    <summary class="cursor-pointer text-white font-medium flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <img src="donet.png" alt="Support" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>Support / Donate</span>
      </div>
      <svg class="w-4 h-4 text-white transition-transform duration-300 group-open:rotate-180"
        xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24">
        <path d="M7 10l5 5 5-5H7z" />
      </svg>
    </summary>
    <div class="mt-1 space-y-2 pl-4 text-sm text-purple-300">
      <a href="https://line.me/..." target="_blank" class="flex items-center space-x-2 hover:underline rounded-xl bg-[#1e0a2a] px-4 py-2">
        <img src="line-icon.png" alt="LINE" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>LINE</span>
      </a>

      <a href="https://t.me/..." target="_blank" class="flex items-center space-x-2 hover:underline rounded-xl bg-[#1e0a2a] px-4 py-2">
        <img src="telegram-icon.png" alt="Telegram" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>Telegram</span>
      </a>
    </div>
  </details>

  <!-- ติดต่อเรา -->
  <details class="group bg-[#2e1b44] rounded-xl px-4 py-3">
    <summary class="cursor-pointer text-white font-medium flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <img src="support.png" alt="Contact" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>ติดต่อเรา</span>
      </div>
      <svg class="w-4 h-4 text-white transition-transform duration-300 group-open:rotate-180"
        xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24">
        <path d="M7 10l5 5 5-5H7z" />
      </svg>
    </summary>
    <div class="space-y-2 pl-4 text-sm text-purple-300">
      <a href="mailto:contact@example.com" class="flex items-center space-x-2 hover:underline rounded-xl bg-[#1e0a2a] px-4 py-2">
        <img src="email-icon.png" alt="Email" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>อีเมล</span>
      </a>

      <a href="https://facebook.com/example" target="_blank" class="flex items-center space-x-2 hover:underline rounded-xl bg-[#1e0a2a] px-4 py-2">
        <img src="facebook-icon.png" alt="Facebook" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>Facebook</span>
      </a>

      <a href="tel:0800000000" class="flex items-center space-x-2 hover:underline rounded-xl bg-[#1e0a2a] px-4 py-2">
        <img src="phone-icon.png" alt="Phone" class="w-6 h-6 aspect-square object-contain object-center" />
        <span>โทรศัพท์</span>
      </a>
    </div>
  </details>

  <!-- อื่น ๆ -->
  <a href="privacy-policy.html" class="flex items-center bg-[#2e1b44] rounded-xl px-4 py-3 text-white font-medium space-x-3">
    <img src="privacy-policy.png" alt="Privacy" class="w-6 h-6 aspect-square object-contain object-center" />
    <span>ความเป็นส่วนตัว</span>
  </a>

  <a href="terms-of-service.html" class="flex items-center bg-[#2e1b44] rounded-xl px-4 py-3 text-white font-medium space-x-3">
    <img src="terms.png" alt="Terms" class="w-6 h-6 aspect-square object-contain object-center" />
    <span>เงื่อนไขการใช้งาน</span>
  </a>

  <!-- ปุ่มออกจากระบบ -->
  <div class="flex justify-center mt-10 px-6">
    <button id="sign-out-button"
      onclick="showLogoutConfirm()"
      class="hidden bg-gradient-to-r from-red-500 to-pink-500 text-white font-semibold px-6 py-3 rounded-full shadow-lg hover:from-red-600 hover:to-pink-600 transition duration-300">
      ออกจากระบบ
    </button>
  </div>
</div>
    
<!-- Popup ยืนยันออกจากระบบ -->
   <div id="logout-confirm-popup" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 backdrop-blur-sm z-50 hidden">
  <div class="bg-white rounded-2xl shadow-2xl p-8 w-[90%] max-w-sm text-center animate-fade-in-up">
    <h2 class="text-2xl font-bold mb-4 text-gray-800">ยืนยันการออกจากระบบ</h2>
    <p class="text-gray-500 mb-6">คุณแน่ใจหรือไม่ว่าต้องการออกจากระบบ?</p>
    <div class="flex gap-4 justify-center">
      <button onclick="cancelLogout()" class="flex-1 py-2 rounded-xl border border-gray-300 text-gray-700 hover:bg-gray-100 transition">ยกเลิก</button>
      <button onclick="confirmLogout()" class="flex-1 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">ออกจากระบบ</button>
    </div>
  </div>
   </div>
  <!-- CSS เสริม (อนิเมชั่นเบา ๆ) -->
<style>
@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-in-up {
  animation: fade-in-up 0.3s ease-out;
}
</style>
</div>

  <div id="settings-modal" class="hidden" aria-hidden="true" role="dialog" aria-modal="true" style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;justify-content:center;align-items:center;">
  <div style="background:white;padding:20px;border-radius:8px;width:300px;position:relative;">
    <button id="close-settings-btn" class="close-btn" style="position:absolute;top:10px;right:10px;cursor:pointer;">X</button>
    <h2>ตั้งค่าบัญชี</h2>

    <p>อีเมล: <span id="user-email">-</span> <button onclick="copyEmail()">คัดลอก</button></p>
    <p>ชื่อ: <span id="user-name-setting">-</span></p>

    <label for="language">ภาษา:</label>
    <select id="language" name="language">
      <option value="th">ไทย</option>
      <option value="en">English</option>
    </select>

    <br /><br />

    <label for="notify-toggle">แจ้งเตือน:</label>
    <input type="checkbox" id="notify-toggle" name="notify-toggle" />

    <br /><br />

    <button id="delete-account-btn" style="cursor:pointer;">ลบบัญชี</button>
    <br /><br />
    <button id="logout-btn" style="cursor:pointer;">ออกจากระบบ</button>
  </div>
</div>

<style>
  .hidden { display: none; }
</style>

  <script>
  window.addEventListener('DOMContentLoaded', () => {
    if (window.location.hash === "#account") {
      document.getElementById("home").classList.add("hidden"); // ซ่อนหน้าหลัก
      document.getElementById("account").classList.remove("hidden"); // แสดงหน้าบัญชี
    }
  });
  </script>
  
  <!--ทำงานดาวโหลดเเอป-->
  <script>
  if ('serviceWorker' in navigator) {  // เช็กว่าบราวเซอร์รองรับ Service Worker หรือไม่
    navigator.serviceWorker.register('./service-worker.js')  // ลงทะเบียนไฟล์ service-worker.js
      .then(registration => {  
        console.log('Service Worker Registered');  // ถ้าสำเร็จ แสดงข้อความนี้
      })
      .catch(error => {
        console.log('Service Worker Registration Failed:', error);  // ถ้ามีปัญหา แสดงข้อความ error
      });
  }
  </script>

  <!-- Modal ล็อกอิน -->
   <div id="auth-modal" class="hidden fixed inset-0 bg-white z-50 flex flex-col items-center justify-start px-4 py-10 overflow-y-auto">
     <button onclick="closeAuthModal()" class="absolute top-4 right-4 text-gray-400 hover:text-black text-2xl font-bold" aria-label="Close">&times;</button>
     <img src="gzone.png" alt="GZone" class="w-60 h-auto mb-4 mt-6" />  
     <div class="w-full max-w-md bg-white rounded-2xl shadow-xl p-8 animate-fade-in relative">
       <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">เข้าสู่ระบบ / สมัครสมาชิก</h2>

       <button onclick="googleLogin()" class="w-full mt-4 flex items-center justify-center gap-3 border border-gray-300 py-3 rounded-xl hover:bg-gray-50 transition text-sm font-medium text-black">
         <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" class="h-5 w-5" />
         ดำเนินการต่อด้วย Google
       </button>

       <button onclick="twitterLogin()" class="w-full mt-4 flex items-center justify-center gap-3 border border-gray-300 py-3 rounded-xl hover:bg-gray-50 transition text-sm font-medium text-black">
         <img src="https://www.svgrepo.com/show/448234/twitter.svg" alt="Twitter" class="h-5 w-5" />
         ดำเนินการต่อด้วย Twitter
       </button>
     </div>
   </div>
   
   <!-- CSS Animation -->
   <style>
     .animate-fade-in {
       animation: fadeInUp 0.3s ease-out;
     }
     @keyframes fadeInUp {
       from {
         opacity: 0;
         transform: translateY(30px);
       }
       to {
         opacity: 1;
         transform: translateY(0);
       }
     }
   </style>
   
   <!-- JavaScript -->
   <script>
  function openAuthModal() {
    document.getElementById("auth-modal").classList.remove("hidden");
    document.body.classList.add("overflow-hidden");
  }

  function closeAuthModal() {
    document.getElementById("auth-modal").classList.add("hidden");
    document.body.classList.remove("overflow-hidden");
  }

  async function generateUniqueUsername() {
    const db = firebase.firestore();
    let uniqueUsername = '';
    let isUnique = false;
    while (!isUnique) {
      const randomUsername = 'gzon_user' + Math.floor(Math.random() * 1000000);
      const doc = await db.collection('usernames').doc(randomUsername).get();
      if (!doc.exists) {
        uniqueUsername = randomUsername;
        isUnique = true;
      }
    }
    return uniqueUsername;
  }

  async function googleLogin() {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
      const result = await firebase.auth().signInWithPopup(provider);
      const user = result.user;
      if (result.additionalUserInfo.isNewUser) {
        const uniqueUsername = await generateUniqueUsername();
        await user.updateProfile({ displayName: uniqueUsername });
        await firebase.firestore().collection('usernames').doc(uniqueUsername).set({
          uid: user.uid,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
      }
      closeAuthModal();
    } catch (error) {
      console.error(error);
      alert(error.message);
    }
  }

  async function twitterLogin() {
    const provider = new firebase.auth.TwitterAuthProvider();
    try {
      const result = await firebase.auth().signInWithPopup(provider);
      const user = result.user;
      if (result.additionalUserInfo.isNewUser) {
        const uniqueUsername = await generateUniqueUsername();
        await user.updateProfile({ displayName: uniqueUsername });
        await firebase.firestore().collection('usernames').doc(uniqueUsername).set({
          uid: user.uid,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
      }
      closeAuthModal();
    } catch (error) {
      console.error(error);
      alert("Twitter Login Error: " + error.message);
    }
  }
     
     
     // Logout Popup control
  const logoutPopup = document.getElementById('logout-confirm-popup');

  function showLogoutConfirm() {
    logoutPopup.classList.remove('hidden');
  }

  function cancelLogout() {
    logoutPopup.classList.add('hidden');
  }

  function confirmLogout() {
    firebase.auth().signOut()
      .then(() => logoutPopup.classList.add('hidden'))
      .catch(error => alert('เกิดข้อผิดพลาดในการออกจากระบบ: ' + error.message));
  }

     const openSettingsBtn = document.getElementById("open-settings-btn");
const closeSettingsBtn = document.getElementById("close-settings-btn");
const settingsModal = document.getElementById("settings-modal");
const accountEmail = document.getElementById("account-email");
const accountNameSetting = document.getElementById("account-name-setting");
const languageSelect = document.getElementById("language");
const notifyToggle = document.getElementById("notify-toggle");
const deleteAccountBtn = document.getElementById("delete-account-btn");
const logoutBtn = document.getElementById("logout-btn");

openSettingsBtn.addEventListener("click", () => {
  settingsModal.classList.remove("hidden");
  loadUserData();
});

closeSettingsBtn.addEventListener("click", () => {
  settingsModal.classList.add("hidden");
});

function loadUserData() {
  const user = firebase.auth().currentUser;
  if (!user) return;

  accountEmail.textContent = user.email || "-";
  accountNameSetting.textContent = user.displayName || "-";

  // แสดงปุ่มลบเฉพาะ Google login
  const isGoogle = user.providerData.some(p => p.providerId === "google.com");
  deleteAccountBtn.style.display = isGoogle ? "inline-block" : "none";

  languageSelect.value = localStorage.getItem("language") || "th";
  notifyToggle.checked = localStorage.getItem("notify") === "true";
}

function copyEmail() {
  const email = accountEmail.textContent;
  navigator.clipboard.writeText(email).then(() => {
    alert("คัดลอกอีเมลแล้ว");
  });
}

languageSelect.addEventListener("change", (e) => {
  localStorage.setItem("language", e.target.value);
  alert("เปลี่ยนภาษาแล้ว (รีเฟรชหน้าเว็บเพื่อให้เปลี่ยนจริง)");
});

notifyToggle.addEventListener("change", (e) => {
  localStorage.setItem("notify", e.target.checked);
});

deleteAccountBtn.addEventListener("click", () => {
  if (confirm("คุณแน่ใจหรือไม่ว่าต้องการลบบัญชีนี้?")) {
    const user = firebase.auth().currentUser;
    user.delete()
      .then(() => {
        alert("ลบบัญชีแล้ว");
        settingsModal.classList.add("hidden");
        location.reload();
      })
      .catch((error) => {
        alert("ลบบัญชีไม่สำเร็จ: " + error.message);
      });
  }
});

logoutBtn.addEventListener("click", () => {
  firebase.auth().signOut()
    .then(() => {
      alert("ออกจากระบบแล้ว");
      settingsModal.classList.add("hidden");
      location.reload();
    })
    .catch(error => alert("เกิดข้อผิดพลาดในการออกจากระบบ: " + error.message));
});

  firebase.auth().onAuthStateChanged(user => {
    const loginPrompt = document.getElementById('login-prompt');
    const userDetails = document.getElementById('user-details');
    const userName = document.getElementById('user-name');
    const userEmail = document.getElementById('user-email');
    const signOutButton = document.getElementById('sign-out-button');
    const profileImage = document.getElementById('accountProfileImage');

    if (user) {
      loginPrompt?.classList.add('hidden');
      userDetails?.classList.remove('hidden');
      signOutButton?.classList.remove('hidden');

      if (userName) userName.textContent = user.displayName || 'ชื่อของคุณ';
      if (userEmail) userEmail.textContent = user.email || '';
      if (profileImage && user.photoURL) profileImage.src = user.photoURL;
    } else {
      loginPrompt?.classList.remove('hidden');
      userDetails?.classList.add('hidden');
      signOutButton?.classList.add('hidden');
    }
  });
</script>
    
<!-- เมนูด้านล่าง -->
  </div>
 </div>
  <nav class="fixed bottom-0 left-0 right-0 bg-[#1a0526] text-white flex justify-around items-center h-16 border-t border-purple-800">
    <button onclick="goTo('home')" class="flex flex-col items-center">
      <img src="icon-home.png" class="w-6 h-6" />
      <span class="text-xs">หน้าแรก</span>
    </button>
    <button onclick="goTo('search')" class="flex flex-col items-center">
      <img src="icon-search.png" class="w-6 h-6" />
      <span class="text-xs">ค้นหา</span>
    </button>
    <button onclick="goTo('account')" class="flex flex-col items-center">
      <img src="icon-user.png" class="w-6 h-6" />
      <span class="text-xs">บัญชี</span>
    </button>
  </nav>

<script>
  const carousel = document.getElementById("banner-carousel");
  const dots = [
    document.getElementById("dot0"),
    document.getElementById("dot1"),
    document.getElementById("dot2"),
  ];
  let index = 1, total = 3, allowClick = true;

  const updateDots = () => {
    dots.forEach((dot, i) => {
      dot.classList.toggle("active", i === (index - 1 + total) % total);
    });
  };

  const goToSlide = (i) => {
    carousel.style.transition = "transform 0.5s ease-in-out";
    carousel.style.transform = `translateX(-${i * 100}%)`;
    updateDots();
  };

  const nextSlide = () => {
    if (!allowClick) return;
    allowClick = false;
    index++;
    goToSlide(index);
    setTimeout(() => {
      if (index === total + 1) {
        carousel.style.transition = "none";
        index = 1;
        carousel.style.transform = `translateX(-${index * 100}%)`;
      }
      allowClick = true;
    }, 600);
  };

  let interval = setInterval(nextSlide, 3000);
  carousel.style.transform = `translateX(-${index * 100}%)`;
  updateDots();

  // Swipe gesture
  let startX = 0;
  carousel.addEventListener("touchstart", (e) => {
    startX = e.touches[0].clientX;
  });

  carousel.addEventListener("touchend", (e) => {
    const endX = e.changedTouches[0].clientX;
    const diff = startX - endX;
    if (Math.abs(diff) > 50) {
      if (diff > 0) {
        nextSlide();
      } else {
        index = (index - 2 + total) % total + 1;
        goToSlide(index);
      }
    }
  });

  // Navigation
  function goTo(page) {
    // ซ่อนทุกหน้าก่อน
    ["home", "search", "account"].forEach(id => {
      document.getElementById(id).classList.add("hidden");
    });
    
    // แสดงหน้าเลือก
    document.getElementById(page).classList.remove("hidden");

    const logoBar = document.getElementById("logoBar");
    
    // แสดงหรือซ่อน logoBar ตามหน้า
    if (page === "home") {
      logoBar.classList.remove("hidden");
    } else {
      logoBar.classList.add("hidden");
    }
  }

  // ฟังก์ชันแสดงเกม
function renderGames(games) {
  const container = document.getElementById("searchResults");
  container.innerHTML = games.length
    ? games.map(g => `
      <div class="flex justify-between items-center bg-[#2e1b44] p-2 rounded-xl">
        <div class="flex items-center space-x-3">
          <img src="${g.image}" class="w-14 h-14 rounded-lg object-cover" />
          <div>${g.name}</div>
        </div>
        <a href="${g.link}" target="_blank" class="bg-purple-500 px-4 py-1 rounded-xl text-sm">ดาวน์โหลด</a>
      </div>`).join("")
    : `<div class="text-center text-gray-400 mt-6">ไม่พบเกมที่คุณค้นหา</div>`;
}

// แสดงเกมทั้งหมดเมื่อเข้าเพจ
document.addEventListener("DOMContentLoaded", () => {
  renderGames(gameList);
});

// ค้นหาเมื่อกดแว่นขยาย
document.getElementById("searchButton").addEventListener("click", () => {
  const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
  const matched = gameList.filter(g => g.name.toLowerCase().includes(keyword));
  renderGames(matched);
});

// ค้นหาเมื่อกด Enter
document.getElementById("searchInput").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    document.getElementById("searchButton").click();
  }
});
</script>                                                       
  
</body>
</html>
