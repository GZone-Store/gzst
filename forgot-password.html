<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ลืมรหัสผ่าน - Gzone</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
  <!-- กล่องฟอร์ม -->
  <div class="bg-white p-6 rounded-xl shadow-lg w-full max-w-md text-center">
    <h2 class="text-2xl font-bold mb-4 text-purple-700">ลืมรหัสผ่าน</h2>
    <p class="text-gray-600 mb-6">กรอกอีเมลที่ใช้สมัครสมาชิก ระบบจะส่งลิงก์ให้คุณตั้งรหัสใหม่</p>
    
    <input type="email" id="reset-email" placeholder="อีเมลของคุณ"
           class="w-full p-3 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-purple-500">
    
    <button onclick="handleForgotPassword()"
            class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition">
      ส่งลิงก์รีเซ็ตรหัสผ่าน
    </button>

    <p id="message" class="mt-4 text-sm"></p>

    <a href="index.html"
       class="text-sm text-purple-600 mt-6 inline-block hover:underline">ย้อนกลับไปหน้าเข้าสู่ระบบ</a>
  </div>

  <!-- Spinner Loading -->
  <div id="loader" class="hidden fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
    <div class="w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
  </div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAuWomazKXngJRI5eGaLs3YPNJ0fQ1-_Hc",
      authDomain: "gzone-store.firebaseapp.com",
      projectId: "gzone-store",
      storageBucket: "gzone-store.appspot.com",
      messagingSenderId: "20383169229",
      appId: "1:20383169229:web:e225735efbea6589120784",
      measurementId: "G-WZLDR9JQKS"
    };
    firebase.initializeApp(firebaseConfig);

    function handleForgotPassword() {
      const email = document.getElementById('reset-email').value.trim();
      const messageEl = document.getElementById('message');
      const loader = document.getElementById('loader');

      if (!email) {
        messageEl.textContent = "กรุณากรอกอีเมล";
        messageEl.className = "text-red-500";
        return;
      }

      loader.classList.remove("hidden");

      firebase.auth().sendPasswordResetEmail(email)
        .then(() => {
          loader.classList.add("hidden");
          messageEl.className = "text-green-600 font-semibold";
          messageEl.textContent = "ส่งลิงก์รีเซ็ตรหัสผ่านแล้ว กรุณาตรวจสอบกล่องอีเมล";
        })
        .catch((error) => {
          loader.classList.add("hidden");
          if (error.code === "auth/user-not-found") {
            messageEl.className = "text-red-500";
            messageEl.textContent = "ไม่พบบัญชีอีเมลนี้ในระบบ";
          } else {
            messageEl.className = "text-red-500";
            messageEl.textContent = "เกิดข้อผิดพลาด: " + error.message;
          }
        });
    }
  </script>
</body>
</html>
